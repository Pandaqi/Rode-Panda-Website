(()=>{var e,o,u,h,f,p,g,_,w,O,E,S,M,ge=Object.create,d=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,fe=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty,he=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ue=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(e,t)=>(typeof require!="undefined"?require:e)[t]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),de=(e,t)=>function(){return t||(0,e[F(e)[0]])((t={exports:{}}).exports,t),t.exports},le=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of F(t))!me.call(e,o)&&o!==n&&d(e,o,{get:()=>t[o],enumerable:!(s=pe(t,o))||s.enumerable});return e},ce=(e,t,n)=>(n=e!=null?ge(fe(e)):{},le(t||!e||!e.__esModule?d(n,"default",{value:e,enumerable:!0}):n,e)),t=(e,t,n)=>(he(e,typeof t!="symbol"?t+"":t,n),n),re=de({"ns-hugo:C:\\Users\\Tiamo\\Documents\\Programming\\Websites\\Pandaqi\\Pandaqi Studio\\pandaqi-studio-dev\\assets\\js\\pq_games\\tools\\random\\seedrandom.js"(e,t){!function(e,n,s){var r,o=256,d="random",m=s.pow(o,6),u=s.pow(2,52),f=2*u,i=o-1;function c(t,i,c){function v(){for(var e=g.g(6),n=m,t=0;e<u;)e=(e+t)*o,n*=o,t=g.g(1);for(;f<=e;)e/=2,n/=2,t>>>=1;return(e+t)/n}var b=[],j=l(function e(t,n){var o,s=[],i=typeof t;if(n&&"object"==i)for(o in t)try{s.push(e(t[o],n-1))}catch{}return s.length?s:"string"==i?t:t+"\0"}((i=1==i?{entropy:!0}:i||{}).entropy?[t,a(n)]:t??function(){try{return r&&(t=r.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),a(t)}catch{var t,s=e.navigator,i=s&&s.plugins;return[+new Date,e,i,e.screen,a(n)]}}(),3),b),g=new p(b);return v.int32=function(){return 0|g.g(4)},v.quick=function(){return g.g(4)/4294967296},v.double=v,l(a(g.S),n),(i.pass||c||function(e,t,n,o){return o&&(o.S&&h(o,g),e.state=function(){return h(g,{})}),n?(s[d]=e,t):e})(v,j,"global"in i?i.global:this==s,i.state)}function p(e){var c,a=e.length,t=this,n=0,r=t.i=t.j=0,s=t.S=[];for(a||(e=[a++]);n<o;)s[n]=n++;for(n=0;n<o;n++)s[n]=s[r=i&r+e[n%a]+(c=s[n])],s[r]=c;(t.g=function(e){for(var r,c=0,s=t.i,a=t.j,n=t.S;e--;)r=n[s=i&s+1],c=c*o+n[i&(n[s]=n[a=i&a+r])+(n[a]=r)];return t.i=s,t.j=a,c})(o)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function l(e,t){for(var o,s=e+"",n=0;n<s.length;)t[i&n]=i&(o^=19*t[i&n])+s.charCodeAt(n++);return a(t)}function a(e){return String.fromCharCode.apply(0,e)}if(l(s.random(),n),"object"==typeof t&&t.exports){t.exports=c;try{r=ue("crypto")}catch{}}else"function"==typeof define&&define.amd?define(function(){return c}):s["seed"+d]=c}("undefined"!=typeof self?self:e,[],Math)}}),c=(e,t=Math.random)=>{for(let n=e.length-1;n>0;n--){const s=Math.floor(t()*(n+1));[e[n],e[s]]=[e[s],e[n]]}return e},n=(e,t,n="fail")=>{const s=new CustomEvent("error-message",{detail:{text:e,type:n,id:t}});document.body.dispatchEvent(s)},ae=class{node;id;constructor(e={}){if(this.id=e.id,this.listenForSignals(),!e.showErrors)return;this.createContainer()}listenForSignals(){document.body.addEventListener("error-message",e=>{if(e.detail.id!=this.id)return;this.show(e.detail.text,e.detail.type)})}createContainer(){const e=document.createElement("div");e.classList.add("error-handler"),this.node=e,document.body.appendChild(e)}show(e,t="fail"){if(console.error(...e),!this.node)return;const n=document.createElement("div");n.classList.add("error-message","error-type-"+t);let s="<p>"+e.toString()+"</p>";if(Array.isArray(e)){s="";for(const t of e)s+="<p>"+t.toString()+"</p>"}let o="<strong>Error (from id '"+this.id+"'): </strong>";n.innerHTML=o+s,this.node.appendChild(n),n.addEventListener("click",e=>(n.remove(),e.stopPropagation(),e.preventDefault(),!1))}},a=class{value;type;constructor(e,t=0){this.value=e,this.type=t}set(e){this.value=e}get(){return this.value}isValid(){return this.value&&this.value.length>=1}},v=class{quizID;type;question;comment;category;media;score;correct;answers;author;color;url;constructor(){this.category=[],this.media=[],this.answers=[],this.question=[],this.author=[],this.comment=[]}hasQuestion(){return this.question.length>=1}hasAnswers(){return this.answers.length>=1}hasCorrectAnswer(){return this.correct.isValid()}hasMedia(){return this.media.length>=1}shuffleAnswers(e){if(this.isOpen())return;c(this.answers,e)}isMultipleChoice(){return this.type.get()=="multiple"}isOpen(){return this.type.get()=="open"||this.type.get()=="opensingle"}isValid(){const e=this.getQuestionValues("question",1),t=this.getQuestionValues("question",1);return e.length>0&&t.length>0}finalize(e){if(this.quizID=e.id,!this.isValid()){n(["Question wants to be finalized, but isn't valid.",this],this.quizID);return}this.finalizeCategories(e),this.finalizeCorrectAnswer(e),this.finalizeAuthor(e);const t=this.answers.length==1?"open":"multiple";if(this.type=this.type??new a(t),this.score||(this.score=new a(e.defaultScore+"")),this.isMultipleChoice()){const t=this.answers.length<(e.minAnswers??2);t&&n(["Multiple choice question has too few answers",this],this.quizID);const s=this.answers.length>(e.maxAnswers??1/0);s&&n(["Multiple choice question has too many answers",this],this.quizID)}}finalizeAuthor(e){if((!this.author||this.author.length<=0)&&(this.author=[new a(e.defaultAuthor)]),e.possibleAuthors){const t=this.getQuestionValues("author");for(const s of t){if(e.possibleAuthors.includes(s))continue;n(["Question has author "+s+" which is not a possible author",this],this.quizID)}}}finalizeCategories(e){if((!this.category||this.category.length<=0)&&(this.category=[new a(e.defaultCategory)]),e.possibleCategories){const t=this.getQuestionValues("category");for(const s of t){if(e.possibleCategories.includes(s))continue;n(["Question has category "+s+" which is not a possible category",this],this.quizID)}}}finalizeCorrectAnswer(){this.correct||(this.correct=this.answers[0]);const s=this.getQuestionValues("answers",1);let t=s.includes(this.correct.get());if(!t)for(const e of s){if(e.toLowerCase()!=this.correct.get().toLowerCase())continue;n(["Question had a correct answer ("+this.correct.get()+"), but spelled differently from the real one ("+e+")",this],this.quizID),this.correct=new a(e),t=!0;break}t||(n(["Question has no valid correct answer ",this],this.quizID),this.correct=this.answers[0]);const o=this.correct.type==2;o&&n(["Question's correct answer is not question visible",this],this.quizID)}updateProperty(e,t,s={}){if(t.length<=0)return;if(Array.isArray(t)||(t=[t]),!Object.keys(this).includes(e)){n(["Unknown question property: "+e,this],this.quizID);return}const o=N(e,t,s);if(o.length<=0){n("Can't set property "+e+" to empty value: "+t,this.quizID);return}const i=Array.isArray(this[e]);if(!i){o.length<=1?this[e]=o[0]:n("Can't set (single) property "+e+" to value "+t,this.quizID);return}for(const t of o)this[e].push(t)}getPropertySingle(e){const t=this.getQuestionValues(e);return t?Array.isArray(t)?t[0]:t:""}propertyAlreadyHasData(e){const t=this[e];return Array.isArray(t)?t.length>0:typeof t=="object"?Object.keys(t).length>0:t}isCorrectAnswer(e){return this.correct.get()==e||this.correct.get()==H(e)}getQuestionValues(e,t=0){let n=this[e];Array.isArray(n)||(n=[n]);const o=[];let s=[1,0,2];t==1?s=[1,0]:t==2&&(s=[2,0]);for(const e of n){if(!s.includes(e.type))continue;o.push(e.get())}return o}getAnswers(e){const t=this.getQuestionValues("answers",e);return this.type.get()=="opensingle"?[r(t)]:t}toString(){return"<strong>&ldquo;"+this.getQuestionValues("question").join(" ")+"&rdquo;</strong>"}},b=["jpg","jpeg","png","webp","gif"],j=["mp3","ogg","wav","m4a"],y=["mp4","webm","mov","avi"],ie=["http://","https://","www.",".com"],oe=["category","media","answers","author"],se=["category","author","type"],x="?",C="!",ne=",",W="=>",B="//",m=(e,t={})=>{const n=l(e),s=t.mediaFormats??[b,j,y].flat();return s.includes(n)},I=async(e,t)=>{const n=l(e);if(n=="txt"||n=="md")return t;if(n=="json")return JSON.parse(t);if(n=="doc"||n=="docx")return U(e);n=="pdf"},P=(e,t,n={})=>{const o=t.questions,s=[];for(const i of o){const t=new v;for(const[s,e]of Object.entries(i)){if(typeof e!="string"||!Array.isArray(e))continue;t.updateProperty(s,e,n)}t.url=e,t.finalize(n),s.push(t)}return s},L=(e,t,s={})=>{const r=t.split(/\r?\n/),c=s.symbols.comment??B,l=s.symbols.property??W;let o=null,i=null;const a=[];for(const d of r){const u=d.length<=0;if(u)continue;const h=d.trim().indexOf(c)==0;if(h)continue;let t=d.split(l);t=t.map(e=>e.trim());const m=t.length>2;if(m){n("Can't parse invalid line: "+d,s.id);continue}const f=t.length<=1;if(f){if(!o){n(["Can't continue property because no question started: ",t],s.id);continue}const e=t[0];o.updateProperty(i,[e],s);continue}t[0]=t[0].toLowerCase(),i=t[0];const p=i=="question";if(p){const t=o!=null;t&&(o.finalize(s),a.push(o)),o=new v,o.url=e}const g=z(i,t[1],s);o.updateProperty(i,g,s)}return o.finalize(s),a.push(o),a},Z=e=>oe.includes(e),z=(e,t,n={})=>{if(t.length<=0)return[];if(Z(e)&&n.enableInlineMultiple){const e=n.symbols.inlineMultiple??ne;return t.split(e)}return[t]},N=(e,t,n={})=>{t=t.map(e=>e.trim()),se.includes(e)&&(t=t.map(e=>e.toLowerCase())),t=t.filter(e=>e!=""),n.symbols||(n.symbols={});const o=n.symbols.questionOnly??x,i=n.symbols.answerOnly??C,s=[];for(let e of t){const r=e.charAt(0);let n=0;r==o?(e=e.slice(1).trim(),n=1):r==i&&(e=e.slice(1).trim(),n=2),s.push(new a(e,n))}return s},T=(e,t)=>{for(const n of e)for(const e of t)if(n.toString().toLowerCase().trim()==e.toString().toLowerCase().trim())return!0;return!1},R=(e,t)=>{const n=new Set;for(const s of e){const o=s.getQuestionValues(t);for(const e of o)n.add(e)}return Array.from(n)},l=e=>{const t=e.split(".");return t[t.length-1]},H=e=>{const t=e.split("/");return t[t.length-1]},r=e=>e.join("<br>"),A=(e,t={})=>{const n=t.linkPrefixes??ie;for(const t of n)if(e.includes(t))return!0;return!1},V=e=>{const t=[];for(const n of Object.values(e))t.push(n);return t.flat()},$=e=>{const t=[];for(const s of e){const n={};for(const e of Object.keys(s)){const t=s[e];if(Array.isArray(t)){const s=[];for(const e of t)s.push(k(e));n[e]=s}else n[e]=k(t)}t.push(n)}const n={questions:t};return n},k=e=>{if(!(e instanceof a))return e;const t=e.get();if(e.type==0)return t;if(e.type==2)return C+t;if(e.type==1)return x+t},U=async e=>"CAN'T PARSE WORD DOCUMENTS, all libraries for some fucking reason require Node and a bunch of dependencies. I tried, I really tried.",K="/pub-quiz/",q="questions",Y=5,G=["txt"],X=["txt","md","json"],Q={media:"media/",questions:"questions/"},D=class{params;url;filename;filenames;fileExtensions;cache;maxScore;data;subFolders;id;constructor(e={}){this.params=e,this.url=e.url??K,this.maxScore=e.maxScore??Y,this.filename=e.filename??q,this.filenames=e.filenames??[],this.fileExtensions=e.fileExtensions??G,this.id=e.id,this.ensureFileExtensionValidity(),this.subFolders=Object.assign(structuredClone(Q),e.subFolders),this.ensureSubFolderValidity(),this.cache={}}getData(){return this.data}getCache(){return this.cache}async load(){const n=this.getURLsToLoad("questions"),t=[];for(const e of n)t.push(this.loadFile(e));await Promise.all(t);const e=V(this.cache);return this.ensureQuestionValidity(e),this.ensureMediaValidity(e),this.data=e,e}getURLsToLoad(e="questions"){return this.filenames.length>0?this.getURLsFixed(e):this.getURLsInSequence(e)}getURLsFixed(e="questions"){const t=[];for(const s of this.filenames){const n=this.getFilePath(s,"txt",e),o=this.fileExists(n);if(!o)break;t.push(n)}return t}getURLsInSequence(e="questions"){let n=0,t=!0;const s=[];for(;t;){let o="",i=!1;for(const s of this.fileExtensions)if(o=this.getFilePath(this.filename+"_"+n,s,e),t=this.fileExists(o),t){i=!0;break}if(n++,!i)break;s.push(o)}return s}async loadFile(e){if(this.inCache(e))return;return new Promise((t)=>{const s=new XMLHttpRequest;s.open("GET",e),s.onerror=e=>{t(!1)},s.onloadend=async()=>{if(s.status==404){t(!1);return}s.status==200&&(await this.onFileLoaded(e,s.response),t(!0))},s.send()})}async onFileLoaded(e,t){const n=await I(e,t);let s;typeof n=="object"?s=P(e,n,this.params):s=L(e,n,this.params),this.addToCache(e,s)}inCache(e){return e in this.cache}addToCache(e,t){this.cache[e]=t}getFilePath(e,t="txt",n="media"){let s=this.url+(this.subFolders[n]??"")+e;return A(e,this.params)&&(s=e),t.length<=0?s:s+"."+t}fileExists(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),t.status!==404}ensureQuestionValidity(e){for(const s of e){const t=parseInt(s.score.get());(t>this.maxScore||t<=0)&&n(["Question has a score that's too high or too low: "+t,s],this.id)}}ensureMediaValidity(e){for(const t of e)this.ensurePathValidity(t,"media"),this.ensurePathValidity(t,"answers")}ensurePathValidity(e,t){const s=[];for(const i of e[t]){const a=i.get(),o=this.getFilePath(a,"","media"),r=m(l(o),this.params);let c=r?o:a;r&&!this.fileExists(o)&&n(["Media doesn't exist: "+o],this.id),i.set(c),s.push(i)}e[t]=s}ensureSubFolderValidity(){for(const[t,e]of Object.entries(this.subFolders)){const n=e.charAt(e.length-1);n!="/"&&(this.subFolders[t]=e+"/")}}ensureFileExtensionValidity(){const e=[];for(const t of this.fileExtensions){if(!X.includes(t))continue;e.push(t)}this.fileExtensions=e}},J=65,ee=class{params;nodes;nodesUI;alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";answerNodes;answerRevealed;mediaNodes;fontSizes=[9,12,16,20,24,28,32];fontSizeDefault=20;startButtonText="Play the Questions!";answerButtonText="View the Answers!";openQuestionText="This is an open question!";loadingScreen={questionNumber:"?",questionCategory:"Loading",question:"Loading ...",instruction:"The quiz is loading all your juicy questions!"};startScreen={questionNumber:"?",questionCategory:"Start",question:"Welcome to the quiz!",instruction:"<p>For each question, write down the number and your answer. Is everyone ready?</p>"};endScreen={question:"Het einde is bereikt!",questionCategory:"Einde",questionNumber:"?",instruction:"<p>You've finished all the questions!</p><p>Reload this page to view the answers.</p>"};node;statsNode;currentTheme;loadExternalMediaAsIframe;hiddenNodes;openQuestionRemark;enableUI;enableSafety;constructor(e){this.hiddenNodes=[],e.hideAuthor&&this.hiddenNodes.push("questionAuthor"),e.hideCategory&&this.hiddenNodes.push("questionCategory"),e.hideScore&&this.hiddenNodes.push("questionScore"),e.enableUI=e.enableUI??!0,this.params=e,this.enableUI=e.enableUI,this.loadExternalMediaAsIframe=e.loadExternalMediaAsIframe??!1,this.enableSafety=e.enableSafety,this.nodes={},this.nodesUI={},this.answerRevealed=!1}createHTML(){const e=document.createElement("div");if(e.classList.add("quiz-container"),document.body.appendChild(e),this.node=e,this.enableUI){const t=document.createElement("div");t.classList.add("quiz-ui"),e.appendChild(t),this.nodesUI.container=t;const n=document.createElement("button");n.innerHTML="Previous",t.appendChild(n),this.nodesUI.prevButton=n;const s=document.createElement("button");s.innerHTML="Font -",t.appendChild(s),this.nodesUI.fontSizeMinButton=s;const a=document.createElement("div");a.style.width="100%",t.appendChild(a);const o=document.createElement("button");o.innerHTML="Font +",t.appendChild(o),this.nodesUI.fontSizePlusButton=o;const i=document.createElement("button");i.innerHTML="Next",t.appendChild(i),this.nodesUI.nextButton=i}const a=document.createElement("div");a.classList.add("question-header"),e.appendChild(a);const t=document.createElement("div");t.classList.add("question-metadata"),a.appendChild(t);const s=document.createElement("div");s.title="Question number",s.classList.add("question-number","metadata-part"),t.appendChild(s),this.nodes.questionNumber=s;const o=document.createElement("div");o.title="Question score",o.classList.add("question-score","metadata-part"),t.appendChild(o),this.nodes.questionScore=o;const i=document.createElement("div");i.title="Question category",i.classList.add("question-category","metadata-part"),t.appendChild(i),this.nodes.questionCategory=i;const n=document.createElement("div");n.title="Question author",n.classList.add("question-author","metadata-part"),t.appendChild(n),this.nodes.questionAuthor=n;const r=document.createElement("h1");r.title="The question!",r.classList.add("quiz-question"),a.appendChild(r),this.nodes.question=r;const c=document.createElement("div");c.title="Question comment",c.classList.add("question-comment"),e.appendChild(c),this.nodes.questionComment=c;const d=document.createElement("div");d.classList.add("question-media"),e.appendChild(d),this.nodes.media=d;const u=document.createElement("div");u.classList.add("quiz-instruction"),e.appendChild(u),this.nodes.instruction=u;const h=document.createElement("div");h.classList.add("question-answers"),e.appendChild(h),this.nodes.answers=h;const l=document.createElement("div");l.title="Statistics about the entire quiz",l.classList.add("quiz-statistics"),e.appendChild(l),this.statsNode=l,this.changeScreen(this.loadingScreen)}changeScreen(e){this.answerRevealed=!1;for(const[n,t]of Object.entries(this.nodes)){const s=!e[n],o=this.hiddenNodes.includes(n),i=s||o;if(i){t.style.display="none",t.innerHTML="";continue}t.innerHTML=e[n],t.style.display="flex"}}saveStats(e){const t=this.statsNode;t.innerHTML="(Statistics: "+e.numQuestions+" questions, "+e.totalScore+" points)"}toggleLeaveProtection(e){e&&this.enableSafety?window.onbeforeunload=()=>"Are you sure you want to leave?":window.onbeforeunload=null}showStartScreen(e){this.changeScreen(this.startScreen),this.addDefaultButtons(e),this.updateUI(!0,!1),this.toggleLeaveProtection(!1)}showEndScreen(){this.changeScreen(this.endScreen),this.updateUI(!1,!0),this.toggleLeaveProtection(!1)}updateUI(e=!1,t=!1){this.nodesUI.prevButton.disabled=e,this.nodesUI.nextButton.disabled=t}addDefaultButtons(e){const t=document.createElement("button");t.innerHTML=this.startButtonText,t.addEventListener("click",t=>{e.gotoQuestionMode(),e.start(),t.stopPropagation()}),this.nodes.instruction.appendChild(t);const n=document.createElement("button");n.innerHTML=this.answerButtonText,n.addEventListener("click",t=>{e.gotoAnswerMode(),e.start(),t.stopPropagation()}),this.nodes.instruction.appendChild(n)}changeTheme(e){const t="theme-"+e;this.currentTheme&&document.body.classList.remove(this.currentTheme),document.body.classList.add(t),this.currentTheme=t}showQuestion(e,t,n){const s=n==0?1:2,a=t.getQuestionValues("media",s),c=a.length>0,d={question:r(t.getQuestionValues("question",s)),questionComment:r(t.getQuestionValues("comment",s)),questionNumber:e+1,questionCategory:"\u{1F3F7}\uFE0F"+r(t.getQuestionValues("category",s)),questionAuthor:"\u{1F9D4}"+r(t.getQuestionValues("author",s)),questionScore:"\u2B50"+t.score.get(),answers:"Answers here",media:c?"Media here":""};if(this.changeScreen(d),this.changeTheme(t.color.get()),this.updateUI(),this.toggleLeaveProtection(!0),this.mediaNodes=[],c){this.nodes.media.innerHTML="";let t=0;const e=[];for(const n of a)e.push(this.createMediaHTML(t,n)),t++;this.mediaNodes=e;for(const t of e)this.nodes.media.appendChild(t)}const o=t.isOpen();this.answerNodes=[],this.nodes.answers.innerHTML="",this.openQuestionRemark=this.createOpenQuestionRemark(),o&&n==0&&this.nodes.answers.appendChild(this.openQuestionRemark);let l=0;const i=[],u=t.getAnswers(s);for(const e of u)i.push(this.createAnswerHTML(l,e,o)),l++;this.answerNodes=i;for(const e of i)this.nodes.answers.appendChild(e),o&&n==0&&(e.style.display="none");n==1&&this.showAnswer(t)}createOpenQuestionRemark(){const e=document.createElement("div");return e.classList.add("open-question-remark"),e.innerHTML=this.openQuestionText,e}createAnswerHTML(e,t,n){const s=document.createElement("div");s.classList.add("answer"),s.dataset.id=t;const i=!n;if(i){const t=document.createElement("div");t.innerHTML=this.alphabet.charAt(e),t.classList.add("answer-number"),s.appendChild(t)}const o=document.createElement("div");o.classList.add("answer-text"),s.appendChild(o),m(t,this.params)?o.appendChild(this.createMediaHTML(e,t)):o.innerHTML=t;const a=t.length>J;return a?s.classList.add("answer-long"):s.classList.add("answer-short"),s}createMediaHTML(e,t){const n=l(t),i=b.includes(n);if(i){const n=document.createElement("img");return n.src=t,n.dataset.id=e.toString(),n}const s=y.includes(n),a=j.includes(n),r=A(t,this.params)&&!m(t);if(r){if(this.loadExternalMediaAsIframe){const e=document.createElement("iframe");return e.src=t,e}const e=document.createElement("a");return e.href=t,e.innerHTML=t,e}if(s||a){const i=s?"video":"audio",n=document.createElement(i);n.setAttribute("controls","controls"),n.dataset.id=e.toString();const o=document.createElement("source");return o.src=t,n.appendChild(o),n}const o=document.createElement("div");return o.innerHTML="Can't create media: "+t,o}showAnswer(e){this.answerRevealed=!this.answerRevealed;const t=e.isOpen();this.openQuestionRemark.style.display=this.answerRevealed?"none":"block";for(const n of this.answerNodes){const s=e.isCorrectAnswer(n.dataset.id);this.answerRevealed?(s||t?n.classList.add("answer-right"):n.classList.add("answer-wrong"),n.style.display="flex"):(n.classList.remove("answer-right"),n.classList.remove("answer-wrong"),t&&(n.style.display="none"))}}isPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}toggleMedia(){for(const e of this.mediaNodes)if(e instanceof HTMLVideoElement||e instanceof HTMLAudioElement){this.isPlaying(e)?e.pause():e.play();break}}changeFontSize(e){const n=window.getComputedStyle(document.body).fontSize;let t=parseInt(n.slice(0,n.length-2));this.fontSizes.includes(t)||(t=this.fontSizeDefault);let s=this.fontSizes.indexOf(t),o=Math.min(Math.max(s+e,0),this.fontSizes.length-1);document.body.style.fontSize=this.fontSizes[o]+"px"}},te=ce(re()),i=class{enableMouse;enableKeys;fakeElement;enableUI;constructor(e){this.enableMouse=e.enableMouse??!0,this.enableKeys=e.enableKeys??!0,this.enableUI=e.enableUI,this.enableMouse&&document.body.addEventListener("click",this.onNext.bind(this)),this.enableKeys&&document.body.addEventListener("keyup",this.onKeyPress.bind(this)),this.fakeElement=document.createElement("div")}connectToNodes(e){e.enableUI&&(e.nodesUI.prevButton.addEventListener("click",this.onPrev.bind(this)),e.nodesUI.nextButton.addEventListener("click",this.onNext.bind(this)),e.nodesUI.fontSizePlusButton.addEventListener("click",this.onFontSizeChange.bind(this,1)),e.nodesUI.fontSizeMinButton.addEventListener("click",this.onFontSizeChange.bind(this,-1)))}listenFor(e,t){document.body.addEventListener(e,t)}onKeyPress(e){this.fakeElement.focus();const t=e.key,s=e.code;let n=!1;["ArrowUp","ArrowRight"].includes(t)||s=="Space"?(this.onNext(e),n=!0):["ArrowDown","ArrowLeft"].includes(t)?(this.onPrev(e),n=!0):t=="a"?(this.onReveal(),n=!0):t=="m"?(this.onModeChange(),n=!0):t=="Escape"?(this.onSkipToEnd(),n=!0):t=="Enter"?(this.onMedia(),n=!0):t=="+"||t=="="?(this.onFontSizeChange(e,1),n=!0):(t=="-"||t=="_")&&(this.onFontSizeChange(e,-1),n=!0),n&&this.cancelEvent(e)}signal(e,t={}){const n=new CustomEvent(e,{detail:t});document.body.dispatchEvent(n)}onSkipToEnd(){this.signal(i.END)}onModeChange(){this.signal(i.MODE)}onMedia(){this.signal(i.MEDIA)}onReveal(){this.signal(i.REVEAL)}onNext(e){this.signal(i.NEXT),this.cancelEvent(e)}onPrev(e){this.signal(i.PREV),this.cancelEvent(e)}onFontSizeChange(e,t){this.signal(i.FONT_SIZE,{change:e}),this.cancelEvent(t)}cancelEvent(e){return e.stopPropagation(),e.preventDefault(),!1}},s=i;t(s,"NEXT","next"),t(s,"PREV","prev"),t(s,"REVEAL","reveal"),t(s,"MEDIA","media"),t(s,"MODE","mode"),t(s,"END","end"),t(s,"FONT_SIZE","fontSize"),h=e=>Math.abs(e)<3e-5,u=(e,t,n)=>e+(t-e)*n,e=class{x;y;constructor(t=0,n=null){let s=t,o=n;t instanceof e?(s=t.x,o=t.y):typeof t=="object"&&"x"in t&&"y"in t&&(s=t.x,o=t.y),this.x=s??0,this.y=o??this.x}clone(){return new e(this)}isValid(){return this.isNumber(this.x)&&this.isNumber(this.y)}hasValue(){return this.isValid()&&(this.x!=0||this.y!=0)}isZero(){return h(this.length())}isNumber(e){return!isNaN(e)}matches(e){return Math.abs(this.x-e.x)<.003&&Math.abs(this.y-e.y)<.003}toSVGString(){return this.x+" "+this.y}fromAngle(e){return this.x=Math.cos(e),this.y=Math.sin(e),this}setX(e=0){return this.x=e,this}setY(e=0){return this.y=e,this}fromXY(e=0,t=0){return this.setXY(e,t)}setXY(e=0,t=0){return this.set({x:e,y:t})}setFactor(e=0){return this.setXY(e,e)}set(t=new e){return this.isNumber(t)?this.setFactor(t):(t=t,this.setX(t.x),this.setY(t.y),this)}moveX(e=0){return this.setX(this.x+e)}moveY(e=0){return this.setY(this.y+e)}moveXY(e=0,t=0){return this.move({x:e,y:t})}moveFactor(e=0){return this.moveXY(e,e)}add(t=new e){return this.move(t)}sub(t=new e){return this.add(t.clone().scaleFactor(-1))}move(t=new e){return this.isNumber(t)?this.moveFactor(t):(t=t,this.moveX(t.x),this.moveY(t.y),this)}scaleX(e=0){return this.setX(e*this.x)}scaleY(e=0){return this.setY(e*this.y)}scaleXY(e=1,t=1){return this.scale({x:e,y:t})}scaleFactor(e=1){return this.scaleXY(e,e)}mult(e=1){return this.scaleFactor(e)}div(t=new e){return typeof t=="object"?this.scale(new e(1/t.x,1/t.y)):this.scaleFactor(1/t)}scale(t=new e){return this.isNumber(t)?this.scaleFactor(t):(t=t,this.scaleX(t.x),this.scaleY(t.y),this)}angle(){return Math.atan2(this.y,this.x)}angleTo(e){const t=this.length()*e.length(),n=this.dot(e);return h(t)?0:Math.acos(n/t)}angleSignedTo(e){const t=Math.sign(this.cross(e));return t*this.angleTo(e)}negate(){return this.scaleFactor(-1)}normalize(){const e=this.length();return Math.abs(e)<=1e-4?this:this.scaleFactor(1/e)}ortho(){const e=this.x;return this.x=-this.y,this.y=e,this}rotate(e){let n=this.length(),t=this.angle();return t+=e,this.x=Math.cos(t)*n,this.y=Math.sin(t)*n,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}random(){const t=Math.random()*2*Math.PI;return(new e).setXY(Math.cos(t),Math.sin(t))}clamp(t=new e,n=new e){return this.setX(Math.min(Math.max(this.x,t.x),n.x)),this.setY(Math.min(Math.max(this.y,t.y),n.y)),this}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return Math.pow(this.x,2)+Math.pow(this.y,2)}distTo(t=new e){return Math.sqrt(this.distSquaredTo(t))}distSquaredTo(t=new e){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)}vecTo(t=new e){return(new e).setXY(t.x-this.x,t.y-this.y)}halfwayTo(e){return this.clone().add(e).scaleFactor(.5)}lerp(t,n){return new e(u(this.x,t.x,n),u(this.y,t.y,n))}dot(e){return this.x*e.x+this.y*e.y}cross(e){return-this.x*e.y+this.y*e.x}},o=e,t(o,"LEFT",new e(-1,0)),t(o,"RIGHT",new e(1,0)),t(o,"UP",new e(0,-1)),t(o,"DOWN",new e(0,1)),t(o,"ZERO",new e(0,0)),t(o,"CENTER",new e(.5,.5)),t(o,"ONE",new e(1,1)),t(o,"TOP_LEFT",new e(-1,-1)),t(o,"TOP_RIGHT",new e(1,-1)),t(o,"BOTTOM_RIGHT",new e(1,1)),t(o,"BOTTOM_LEFT",new e(-1,1)),O=(e,t=-(1/0),n=1/0)=>(t instanceof o&&(n=t.y,t=t.x),typeof t=="object"&&(n=t.max,t=t.min),Math.max(Math.min(e,n),t)),g="defaultQuizID",_="quiz",w=1,p="anonymous",f="general",E=class{params;questions;loader;nodes;mode;rng;dom;counter;enableSafety;groupBy;colors=["red","orange","green","blue","turquoise","purple","pink"];errorHandler;id;constructor(e={}){this.params=e;const t=e.seed??_;e.defaultAuthor=e.defaultAuthor??p,e.defaultCategory=e.defaultCategory??f,e.defaultScore=e.defaultScore??w,e.showErrors=e.showErrors??!0,e.id=e.id??t??g,e.symbols=e.symbols??{},e.exclude=e.exclude??{},e.include=e.include??{},e.enableInlineMultiple=e.enableInlineMultiple??!0,console.log(e),e.enableSafety=e.enableSafety??!1,this.enableSafety=e.enableSafety,this.groupBy=e.groupBy??null,this.id=e.id,this.mode=0,this.loader=new D(e),this.nodes=new ee(e),this.errorHandler=new ae(e),this.rng=(0,te.default)(t),this.dom=new s(e),this.dom.listenFor(s.NEXT,()=>{this.changeQuestion(1)}),this.dom.listenFor(s.PREV,()=>{this.changeQuestion(-1)}),this.dom.listenFor(s.REVEAL,()=>{this.toggleAnswer()}),this.dom.listenFor(s.MEDIA,()=>{this.toggleMedia()}),this.dom.listenFor(s.MODE,()=>{this.toggleMode()}),this.dom.listenFor(s.END,()=>{this.gotoEnd()}),this.dom.listenFor(s.FONT_SIZE,e=>{this.changeFontSize(e.detail.change)})}async load(){this.nodes.createHTML(),this.dom.connectToNodes(this.nodes),this.questions=await this.loader.load(),this.prepareQuestions(),this.reset()}start(){this.changeQuestion(1)}gotoQuestionMode(){this.mode=0}gotoAnswerMode(){this.mode=1}gotoEnd(){if(this.enableSafety&&!confirm("Are you sure you want to skip to the end?"))return;this.changeQuestion(1/0)}gotoStart(){if(this.enableSafety&&!confirm("Are you sure you want to skip to the start?"))return;this.changeQuestion(-(1/0))}reset(){this.counter=-1,this.changeQuestion(0)}prepareQuestions(){if(this.applyMask(),this.filterExclusions(),this.questions.sort((e,t)=>e.question[0].get().localeCompare(t.question[0].get())),c(this.questions,this.rng),this.groupBy!=null){const e=R(this.questions,this.groupBy);c(e,this.rng),this.questions.sort((t,n)=>{const s=e.indexOf(t.getPropertySingle(this.groupBy)),o=e.indexOf(n.getPropertySingle(this.groupBy));return s-o})}this.assignColors();let e=0;for(const t of this.questions)e+=parseInt(t.score.get()),t.shuffleAnswers(this.rng);const t={numQuestions:this.questions.length,totalScore:e};this.nodes.saveStats(t),console.log("### Questions ###"),console.log(this.questions),console.log("### JSON Output ###"),console.log($(this.questions))}changeQuestion(e){if(this.counter=O(this.counter+e,-1,this.questions.length),this.counter<=-1)return this.nodes.showStartScreen(this);if(this.counter>=this.questions.length)return this.nodes.showEndScreen(this);this.nodes.showQuestion(this.counter,this.getCurrentQuestion(),this.mode)}getCurrentQuestion(){return this.counter<0||this.counter>=this.questions.length?null:this.questions[this.counter]}toggleAnswer(){if(this.enableSafety&&!confirm("Are you sure you wish to toggle answers?"))return;this.toggleMode(!0),this.changeQuestion(0)}toggleMedia(){this.nodes.toggleMedia()}toggleMode(e=!1){if(this.enableSafety&&!e&&!confirm("Are you sure you want to toggle mode (questions<->answers)?"))return;this.mode==1?this.gotoQuestionMode():this.gotoAnswerMode(),this.changeQuestion(0)}changeFontSize(e){this.nodes.changeFontSize(e)}filterExclusions(){const t=Object.keys(this.params.exclude).length>0;if(!t)return;const e=[];for(const t of this.questions){let n=!1;for(const[s,e]of Object.entries(this.params.exclude)){const o=t.getQuestionValues(s),i=Array.isArray(e)?e:[e];if(T(i,o)){n=!0;break}}if(n)continue;e.push(t)}this.questions=e}applyMask(){const t=Object.keys(this.params.include).length>0;if(!t)return;const e=[];for(const t of this.questions){let n=!1;for(const[s,e]of Object.entries(this.params.exclude)){const o=t.getQuestionValues(s),i=Array.isArray(e)?e:[e];if(T(i,o)){n=!0;break}}if(!n)continue;e.push(t)}this.questions=e}assignColors(){const e=[],t=this.colors.length,n=this.questions.length,s=Math.ceil(n/t);for(let t=0;t<s;t++)for(const t of this.colors)e.push(t);c(e,this.rng);for(const t of this.questions)t.updateProperty("color",e.pop())}atStart(){return this.counter<0}atEnd(){return this.counter>=this.questions.length}},S={seed:"newyearsevequiz2024",loadExternalMediaAsIframe:!0,groupBy:"category"},M=new E(S),M.load()})()